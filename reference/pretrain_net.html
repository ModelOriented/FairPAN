<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Pretrains the neural network — pretrain_net • fairpan</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- dalexverse -->
<link href="../dalexverse.css" rel="stylesheet">
<link href="../dalexverse-2.css" rel="stylesheet">

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>






<meta property="og:title" content="Pretrains the neural network — pretrain_net" />
<meta property="og:description" content="Pretrain for both the classifier and adversarial model. You can select which
model it is by setting model_type parameter (it customizes the prints properly).
Pretrain can also collect more data to training analysis and print it out
which is useful for monitoring the learning process and making adjustments." />

<meta name="robots" content="noindex" />


<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- google analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-5650686-14""></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-5650686-14');
</script>

  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">fairpan</a>
        <div class="info">
          <span class="partof">part of the <a href="https://github.com/ModelOriented/DrWhy">DrWhy.AI</a>
           developed by the <a href="https://mi2.mini.pw.edu.pl/">MI^2 DataLab</a> </span>
          <span class="version version-default">0.1.0</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Tutorial.html">FairPAN Tutorial</a>
    </li>
  </ul>
</li>
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Pretrains the neural network</h1>
    
    <div class="hidden name"><code>pretrain_net.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Pretrain for both the classifier and adversarial model. You can select which
model it is by setting model_type parameter (it customizes the prints properly).
Pretrain can also collect more data to training analysis and print it out
which is useful for monitoring the learning process and making adjustments.</p>
    </div>

    <pre class="usage"><span class='fu'>pretrain_net</span><span class='op'>(</span>
  n_epochs <span class='op'>=</span> <span class='fl'>15</span>,
  <span class='va'>model</span>,
  <span class='va'>dsl</span>,
  <span class='va'>model_type</span>,
  learning_rate <span class='op'>=</span> <span class='fl'>0.001</span>,
  <span class='va'>sensitive_test</span>,
  <span class='va'>dev</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  monitor <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>n_epochs</th>
      <td><p>integer setting number of epochs for training. Default: 15</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>net, nn_module, neural network model we want to train</p></td>
    </tr>
    <tr>
      <th>dsl</th>
      <td><p>dataset_loader object for the training</p></td>
    </tr>
    <tr>
      <th>model_type</th>
      <td><p>indicates which model we train (0 for preadversarial, 1 for
preclassifier, 2 for classifier only)</p></td>
    </tr>
    <tr>
      <th>learning_rate</th>
      <td><p>float from [0,1] setting learning rate for model.
Default: 0.001</p></td>
    </tr>
    <tr>
      <th>sensitive_test</th>
      <td><p>test vector for sensitive variable used to calculate
STP</p></td>
    </tr>
    <tr>
      <th>dev</th>
      <td><p>device used to calculations (cpu or gpu)</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical indicating if we want to print monitored outputs or
not</p></td>
    </tr>
    <tr>
      <th>monitor</th>
      <td><p>logical indicating if we want to monitor the learning process
or not (monitoring tends to slow down the training process, but provides
some useful info to adjust parameters and training process)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>list(train_loss,test_loss,optimizer)</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='va'>dev</span> <span class='op'>&lt;-</span> <span class='st'>"cpu"</span>

<span class='co'># presaved output of preprocess function</span>
<span class='va'>processed</span> <span class='op'>&lt;-</span> <span class='fu'>torch_load</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>,<span class='st'>"processed"</span>,package<span class='op'>=</span><span class='st'>"fairpan"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>dsl</span> <span class='op'>&lt;-</span> <span class='fu'><a href='dataset_loader.html'>dataset_loader</a></span><span class='op'>(</span><span class='va'>processed</span><span class='op'>$</span><span class='va'>train_x</span>, <span class='va'>processed</span><span class='op'>$</span><span class='va'>train_y</span>, <span class='va'>processed</span><span class='op'>$</span><span class='va'>test_x</span>,
                      <span class='va'>processed</span><span class='op'>$</span><span class='va'>test_y</span>, batch_size<span class='op'>=</span><span class='fl'>5</span>, dev<span class='op'>=</span><span class='va'>dev</span><span class='op'>)</span>

<span class='co'># presaved torch model</span>
<span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'>torch_load</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata"</span>,<span class='st'>"clf1"</span>,package<span class='op'>=</span><span class='st'>"fairpan"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>pretrain_net</span><span class='op'>(</span>
  n_epochs <span class='op'>=</span> <span class='fl'>1</span>,
  model <span class='op'>=</span> <span class='va'>model</span>,
  dsl <span class='op'>=</span> <span class='va'>dsl</span>,
  model_type <span class='op'>=</span> <span class='fl'>1</span>,
  learning_rate <span class='op'>=</span> <span class='fl'>0.001</span>,
  sensitive_test <span class='op'>=</span> <span class='va'>processed</span><span class='op'>$</span><span class='va'>sensitive_test</span>,
  dev<span class='op'>=</span><span class='va'>dev</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  monitor <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span>
</div><div class='output co'>#&gt; Preclassifier at epoch 1: training loss: 0.462, validation: 0.460, accuracy: 0.838, STPR: 0.315</div><div class='output co'>#&gt; $train_loss
#&gt; [1] 0.4616018
#&gt; 
#&gt; $test_loss
#&gt; [1] 0.4600492
#&gt; 
#&gt; $optimizer
#&gt; &lt;optim_adam&gt;
#&gt;   Inherits from: &lt;torch_Optimizer&gt;
#&gt;   Public:
#&gt;     add_param_group: function (param_group) 
#&gt;     clone: function (deep = FALSE) 
#&gt;     defaults: list
#&gt;     initialize: function (params, lr = 0.001, betas = c(0.9, 0.999), eps = 1e-08, 
#&gt;     load_state_dict: function (state_dict) 
#&gt;     param_groups: list
#&gt;     state: State, R6
#&gt;     state_dict: function () 
#&gt;     step: function (closure = NULL) 
#&gt;     zero_grad: function () 
#&gt;   Private:
#&gt;     step_helper: function (closure, loop_fun) 
#&gt; </div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Hubert Ruczyński, Jakub Wiśniewski.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


